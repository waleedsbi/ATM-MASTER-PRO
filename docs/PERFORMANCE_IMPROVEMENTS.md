# ุชุญุณููุงุช ุงูุฃุฏุงุก - Performance Improvements

## ๐ ุงููุดููุฉ
ุงููุธุงู ูุงู ูุฃุฎุฐ ููุช ุทููู ูู ุชุญููู ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.

## โ ุงูุญููู ุงููุทุจูุฉ

### 1. **ุฅุถุงูุฉ Caching ูููุญุฉ ุงูุชุญูู**
- ุชู ุฅุถุงูุฉ cache ููุฏุฉ 30 ุซุงููุฉ ูููุญุฉ ุงูุชุญูู
- ุชูููู ุงุณุชุนูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุดูู ูุจูุฑ
- ุงุณุชุฎุฏุงู `stale-while-revalidate` ูุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู

```typescript
// Cache for 30 seconds
export const revalidate = 30;
response.headers.set('Cache-Control', 'public, s-maxage=30, stale-while-revalidate=60');
```

### 2. **ุชุญุณูู ุงุณุชุนูุงูุงุช ุงูุฅุดุนุงุฑุงุช**
- ุฏูุฌ ุงุณุชุนูุงูุงุช `count` ู `findMany` ูู `Promise.all` ููุชูููุฐ ุงููุชูุงุฒู
- ุงุณุชุฎุฏุงู `select` ููุท ููุญููู ุงููุทููุจุฉ ูุชูููู ุงูุจูุงูุงุช ุงููููููุฉ
- ุฅุถุงูุฉ cache ููุฏุฉ 10 ุซูุงูู ููุฅุดุนุงุฑุงุช

```typescript
// Execute count and findMany in parallel
const [unreadCount, recentComments] = await Promise.all([
  prisma.clientComment.count({...}),
  prisma.clientComment.findMany({...})
]);
```

### 3. **ุชุญุณูู ุงุณุชุนูุงูุงุช Dashboard**
- ุฅุถุงูุฉ `where` clauses ูุชูููู ุงูุจูุงูุงุช ุงูููุญูุตุฉ
- ุงุณุชุฎุฏุงู `select` ููุท ููุญููู ุงููุทููุจุฉ
- ุชุญุณูู `groupBy` queries

```typescript
prisma.bankATM.count({
  where: {
    IsDeleted: false,
    IsNotActive: false,
  },
})
```

### 4. **ุฅุถุงูุฉ Database Indexes**
ุชู ุฅุถุงูุฉ indexes ูุชุญุณูู ุฃุฏุงุก ุงูุงุณุชุนูุงูุงุช:

#### ClientComment Table:
- `IX_ClientComment_commentByRole_isRead` - ูุงุณุชุนูุงูุงุช ุงูุฅุดุนุงุฑุงุช
- `IX_ClientComment_createdAt` - ููุชุฑุชูุจ ุญุณุจ ุงูุชุงุฑูุฎ
- `IX_ClientComment_workPlanId` - ููููุชุฑุฉ ุญุณุจ ุฎุทุฉ ุงูุนูู

#### BankATM Table:
- `IX_BankATM_BankCodeId` - ูุงุณุชุนูุงูุงุช groupBy
- `IX_BankATM_IsDeleted_IsNotActive` - ููููุชุฑุฉ ุญุณุจ ุงูุญุงูุฉ

#### WorkPlanHeaders Table:
- `IX_WorkPlanHeaders_IsDeleted` - ููููุชุฑุฉ ุญุณุจ ุงูุญุงูุฉ

## ๐ ููููุฉ ุชุทุจูู ุงูุชุญุณููุงุช

### ุงูุฎุทูุฉ 1: ุชุญุฏูุซ Prisma Schema
```bash
npx prisma db push
```

### ุงูุฎุทูุฉ 2: ุฅุถุงูุฉ Indexes ูุฏููุงู (ุฅุฐุง ูุฒู ุงูุฃูุฑ)
ุงูุชุญ SQL Server Management Studio ููู ุจุชุดุบูู:
```sql
-- File: prisma/add_performance_indexes.sql
```

### ุงูุฎุทูุฉ 3: ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู
```bash
npm run dev
```

## ๐ ุงููุชุงุฆุฌ ุงููุชููุนุฉ

- **ุชูููู ููุช ุงูุชุญููู**: ูู 2-7 ุซูุงูู ุฅูู ุฃูู ูู 1 ุซุงููุฉ
- **ุชูููู ุงุณุชุนูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช**: ุจูุณุจุฉ 60-80%
- **ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู**: ุชุญููู ุฃุณุฑุน ูุฃูุซุฑ ุณูุงุณุฉ

## ๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก

ููููู ูุฑุงูุจุฉ ุงูุฃุฏุงุก ูู ุฎูุงู:
1. **ุณุฌูุงุช Prisma**: ุฑุงูุจ ุงุณุชุนูุงูุงุช `prisma:query` ูู Terminal
2. **Network Tab**: ุฑุงูุจ ููุช ุงุณุชุฌุงุจุฉ API ูู Developer Tools
3. **Database Profiler**: ุงุณุชุฎุฏู SQL Server Profiler ููุฑุงูุจุฉ ุงูุงุณุชุนูุงูุงุช

## ๐ ููุงุญุธุงุช ูููุฉ

1. **Cache Duration**: 
   - Dashboard: 30 ุซุงููุฉ (ุงูุจูุงูุงุช ูุง ุชุชุบูุฑ ูุซูุฑุงู)
   - Notifications: 10 ุซูุงูู (ุงูุจูุงูุงุช ุชุชุบูุฑ ุจุดูู ูุชูุฑุฑ)

2. **Indexes**: 
   - Indexes ุชุญุณู ุฃุฏุงุก ุงููุฑุงุกุฉ ููู ุชุจุทุฆ ุงููุชุงุจุฉ ููููุงู
   - ุงุณุชุฎุฏู indexes ููุท ุนูู ุงูุญููู ุงููุณุชุฎุฏูุฉ ูู WHERE ู ORDER BY

3. **Query Optimization**:
   - ุงุณุชุฎุฏู `select` ููุท ููุญููู ุงููุทููุจุฉ
   - ุงุณุชุฎุฏู `where` clauses ูุชูููู ุงูุจูุงูุงุช ุงูููุญูุตุฉ
   - ุงุณุชุฎุฏู `Promise.all` ููุงุณุชุนูุงูุงุช ุงููุชูุงุฒูุฉ

## ๐๏ธ ุชุญุณููุงุช ุฅุถุงููุฉ ูุญุชููุฉ

1. **Database Connection Pooling**: ุชุญุณูู ุฅุนุฏุงุฏุงุช Prisma connection pool
2. **Query Result Caching**: ุงุณุชุฎุฏุงู Redis ููู caching ุงููุชูุฏู
3. **Pagination**: ุฅุถุงูุฉ pagination ููุฌุฏุงูู ุงููุจูุฑุฉ
4. **Lazy Loading**: ุชุญููู ุงูุจูุงูุงุช ุนูุฏ ุงูุญุงุฌุฉ ููุท

